/**
 * Stella Analytics - Minified (~2KB)
 * Usage: StellaAnalytics.init('sk_your_key', 'https://your-domain.com');
 */
!function(e){"use strict";var t={apiKey:null,baseUrl:null,sessionId:null,queue:[],isTracking:!1,init:function(n,i){n&&i?(this.apiKey=n,this.baseUrl=i.replace(/\/$/,""),this.sessionId=this.getOrCreateSessionId(),this.isTracking=!0,this.trackPageview(),e.addEventListener("beforeunload",this.sendBeacon.bind(this)),console.log("[Stella Analytics] Initialized")):console.error("[Stella Analytics] API key and base URL required")},getOrCreateSessionId:function(){var e=sessionStorage.getItem("stella_session_id");return e||(e="ss_"+Date.now()+"_"+Math.random().toString(36).substr(2,9),sessionStorage.setItem("stella_session_id",e)),e},trackPageview:function(){this.track("pageview",null,{page_url:e.location.href,page_title:document.title,referrer:document.referrer})},track:function(e,t,n){if(this.isTracking){var i={event_type:e,event_name:t,page_url:n&&n.page_url||window.location.href,page_title:n&&n.page_title||document.title,referrer:n&&n.referrer||document.referrer,session_id:this.sessionId,metadata:n||{}};this.queue.push(i),this.flush()}},flush:function(){if(0!==this.queue.length){var e=this.queue.slice();this.queue=[],e.forEach(function(e){this.send(e)}.bind(this))}},send:function(e){var t=this.baseUrl+"/api/analytics.php?action=track";fetch(t,{method:"POST",headers:{"Content-Type":"application/json","X-API-Key":this.apiKey},body:JSON.stringify(e),keepalive:!0}).catch(function(e){console.error("[Stella Analytics] Failed:",e)})},sendBeacon:function(){if(0!==this.queue.length){var e=this.baseUrl+"/api/analytics.php?action=track";this.queue.forEach(function(t){var n=new Blob([JSON.stringify(t)],{type:"application/json"});navigator.sendBeacon(e,n)}),this.queue=[]}},trackClick:function(e,t){this.track("click",e,t)},trackFormSubmit:function(e,t){this.track("form_submit",e,t)},trackDownload:function(e,t){this.track("download",e,t)},trackConversion:function(e,t){this.track("conversion",e,t)}};e.StellaAnalytics=t}(window);


